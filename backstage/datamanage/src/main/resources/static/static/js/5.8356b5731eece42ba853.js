webpackJsonp([5],{"5sW+":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("woOf"),l=a.n(i),o=a("xT6B"),s=a("xV2B"),r=a("OGkF"),n=a("b7kB"),u={data:function(){return{list:null,listQuery:{total:50,pageNum:1,pageSize:5,deviceSuffix:null,customerNo:null,enterpriseId:this.$store.state.user.orgId,status:null,runStatus:null,saleDatetime:null},customerOption:[],isOrNotArray:[{value:1,label:"是"},{value:0,label:"否"}],deviceTypeOption:[],textMap:{update:"编辑",create:"新增"},dialogStatus:"",dialogFormVisible:!1,deviceFormData:{id:"",deviceType:"",status:1,runStatus:1,saleDatetime:""},dialogQRCodeFormVisible:!1,qRCodeFormData:{startSuffix:"",endSuffix:""},qRCodeRules:{startSuffix:[{required:!0,message:"开始编号不能为空",trigger:"blur"}],endSuffix:[{required:!0,message:"结束编号不能为空",trigger:"blur"}]},listLoading:!1}},filters:{statusFilterLabel:function(e,t){return t.filter(function(t){return t.value==e})}},created:function(){this.getList(),this.initCustomerList(),this.initDeviceTypeList()},methods:{initCustomerList:function(){var e=this,t=[];Object(r.a)(this.listQuery.enterpriseId).then(function(a){a.data.data.forEach(function(e){t.push({value:e.code+"",label:e.name})}),e.customerOption=t})},initDeviceTypeList:function(){var e=this,t=[];Object(n.a)().then(function(a){a.data.data.forEach(function(e){t.push({value:e.deviceType,label:e.deviceType})}),e.deviceTypeOption=t})},openTableMenu:function(e,t){this.$refs.menuContext.openTableMenu(e,t)},handleFilter:function(){this.listQuery.pageNum=1,this.getList()},getList:function(){var e=this;this.listLoading=!0,Object(s.d)(this.listQuery).then(function(t){var a=t.data.data;e.list=a.list,e.listQuery.total=a.total,e.listQuery.pageNum=a.pageNum,e.listQuery.pageSize=a.pageSize,e.listLoading=!1})},resetTemp:function(){this.deviceFormData={id:"",deviceType:"",status:1,runStatus:1,saleDatetime:""}},handleCreate:function(){var e=this;this.resetTemp(),this.dialogStatus="create",this.dialogFormVisible=!0,this.$nextTick(function(){e.$refs.deviceFormData.clearValidate()})},handleGenerateQRCode:function(){var e=this;this.qRCodeFormData.startSuffix="",this.qRCodeFormData.endSuffix="",this.dialogQRCodeFormVisible=!0,this.$nextTick(function(){e.$refs.qRCodeForm.clearValidate()})},handleUpdate:function(e){var t=this;this.deviceFormData=l()({},e),this.deviceFormData.saleDatetime||(this.deviceFormData.saleDatetime=Object(o.a)(new Date,"yyyy-MM-dd hh:mm")),this.dialogStatus="update",this.dialogFormVisible=!0,this.$nextTick(function(){t.$refs.deviceFormData.clearValidate()})},generateQRCode:function(){var e=this;this.$refs.qRCodeForm.validate(function(t){if(!t)return!1;e.dialogQRCodeFormVisible=!1,window.open(Object({NODE_ENV:"production"}).BASE_API+"/device/generateqrcode?startSuffix="+e.qRCodeFormData.startSuffix+"&endSuffix="+e.qRCodeFormData.endSuffix,"_blank")})},editData:function(){var e=this;this.$refs.deviceFormData.validate(function(t){if(!t)return!1;Object(s.b)(e.deviceFormData).then(function(t){e.dialogFormVisible=!1,e.$message({message:"成功",type:"success"}),e.getList()})})},handleDelete:function(e){var t=this;this.$confirm("确认删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(s.a)(e.id).then(function(a){t.$message({message:"删除成功",type:"success"}),t.list.splice(t.list.indexOf(e),1)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},handleSizeChange:function(e){this.listQuery.pageSize=e,this.getList()},handleCurrentChange:function(e){this.listQuery.pageNum=e,this.getList()}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{staticClass:"app-query"},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"所属客户"},model:{value:e.listQuery.customerNo,callback:function(t){e.$set(e.listQuery,"customerNo",t)},expression:"listQuery.customerNo"}},e._l(e.customerOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"是否销售"},model:{value:e.listQuery.status,callback:function(t){e.$set(e.listQuery,"status",t)},expression:"listQuery.status"}},e._l(e.isOrNotArray,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"是否运行"},model:{value:e.listQuery.runStatus,callback:function(t){e.$set(e.listQuery,"runStatus",t)},expression:"listQuery.runStatus"}},e._l(e.isOrNotArray,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),a("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"设备编号"},model:{value:e.listQuery.deviceSuffix,callback:function(t){e.$set(e.listQuery,"deviceSuffix",t)},expression:"listQuery.deviceSuffix"}}),e._v(" "),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date","value-format":"yyyy-MM-dd hh:mm",placeholder:"销售时间"},model:{value:e.listQuery.saleDatetime,callback:function(t){e.$set(e.listQuery,"saleDatetime",t)},expression:"listQuery.saleDatetime"}}),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-circle-plus-outline"},on:{click:e.handleGenerateQRCode}},[e._v("生成二维码")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"120%"},attrs:{data:e.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""},on:{"row-contextmenu":e.openTableMenu}},[a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"设备编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.deviceSuffix))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"所属客户"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.customerName))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"设备类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.deviceType))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"是否销售"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("statusFilterLabel")(t.row.status,e.isOrNotArray)[0].label))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"是否运行"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(e._f("statusFilterLabel")(t.row.runStatus,e.isOrNotArray)[0].label)+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"销售时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.saleDatetime))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"left","show-overflow-tooltip":!0,label:"导入时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.importDatetime))])]}}])})],1),e._v(" "),a("menu-context",{ref:"menuContext"},[a("menu-context-item",{on:{click:e.handleUpdate}},[e._v("编辑")]),e._v(" "),a("menu-context-item",{on:{click:e.handleDelete}},[e._v("删除")])],1),e._v(" "),a("div",{staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.pageNum,"page-sizes":[5,10,15,20],"page-size":e.listQuery.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.listQuery.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),e._v(" "),a("div",{staticClass:"el-dialog-device"},[a("el-dialog",{attrs:{title:e.textMap[e.dialogStatus],visible:e.dialogFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"deviceFormData",staticStyle:{width:"90%","margin-left":"15px"},attrs:{model:e.deviceFormData,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"设备类型"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"100%"},model:{value:e.deviceFormData.deviceType,callback:function(t){e.$set(e.deviceFormData,"deviceType",t)},expression:"deviceFormData.deviceType"}},e._l(e.deviceTypeOption,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"是否销售"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"100%"},model:{value:e.deviceFormData.status,callback:function(t){e.$set(e.deviceFormData,"status",t)},expression:"deviceFormData.status"}},e._l(e.isOrNotArray,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"是否运行"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"100%"},model:{value:e.deviceFormData.runStatus,callback:function(t){e.$set(e.deviceFormData,"runStatus",t)},expression:"deviceFormData.runStatus"}},e._l(e.isOrNotArray,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"活动时间"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"选择日期","value-format":"yyyy-MM-dd hh:mm","default-time":"00:00"},model:{value:e.deviceFormData.saleDatetime,callback:function(t){e.$set(e.deviceFormData,"saleDatetime",t)},expression:"deviceFormData.saleDatetime"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.editData}},[e._v("确认")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"生成二维码",visible:e.dialogQRCodeFormVisible,width:"30%"},on:{"update:visible":function(t){e.dialogQRCodeFormVisible=t}}},[a("el-form",{ref:"qRCodeForm",staticStyle:{width:"80%","margin-left":"30px"},attrs:{rules:e.qRCodeRules,model:e.qRCodeFormData,"label-position":"right","label-width":"80px"}},[a("el-form-item",{attrs:{label:"开始编号",prop:"startSuffix"}},[a("el-input",{model:{value:e.qRCodeFormData.startSuffix,callback:function(t){e.$set(e.qRCodeFormData,"startSuffix",t)},expression:"qRCodeFormData.startSuffix"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"结束编号",prop:"endSuffix"}},[a("el-input",{model:{value:e.qRCodeFormData.endSuffix,callback:function(t){e.$set(e.qRCodeFormData,"endSuffix",t)},expression:"qRCodeFormData.endSuffix"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogQRCodeFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.generateQRCode}},[e._v("生成")])],1)],1)],1)],1)},staticRenderFns:[]},d=a("VU/8")(u,c,!1,null,null,null);t.default=d.exports},OGkF:function(e,t,a){"use strict";t.a=function(e){return Object(i.a)({url:"/tokendict/getcustomerlistbyenterpriseid",method:"get",params:{enterpriseId:e}})},t.b=function(e){return Object(i.a)({url:"/tokendict/getcustomerorenterpriselist",method:"get",params:{organizationType:e}})};var i=a("vLgD")},b7kB:function(e,t,a){"use strict";t.a=function(){return Object(i.a)({url:"/devicetype/getdevicetypelist",method:"get"})};var i=a("vLgD")},xV2B:function(e,t,a){"use strict";t.c=function(e){return Object(i.a)({url:"/device/devicelistbyconditionandpage",method:"get",params:e})},t.d=function(e){return Object(i.a)({url:"/device/getdevicelistbyenterpriseidandpage",method:"get",params:e})},t.e=function(e){return Object(i.a)({url:"/device/insertmanydevice",method:"post",data:e})},t.f=function(e){return Object(i.a)({url:"/device/updatemanydeviceno",method:"post",data:e})},t.b=function(e){return Object(i.a)({url:"/device/editdevice",method:"post",data:e})},t.a=function(e){return Object(i.a)({url:"/device/deletedevicebyid",method:"post",params:{id:e}})};var i=a("vLgD")}});
//# sourceMappingURL=5.8356b5731eece42ba853.js.map