{"version":3,"sources":["webpack:///./src/api/role.js","webpack:///src/views/role/index.vue","webpack:///./src/views/role/index.vue?7137","webpack:///./src/views/role/index.vue","webpack:///./src/api/resource.js"],"names":["__webpack_exports__","query","request","url","method","params","employeeId","data","id","__WEBPACK_IMPORTED_MODULE_0__utils_request__","__webpack_require__","views_role","list","listQuery","total","pageNum","pageSize","roleName","textMap","update","create","dialogStatus","dialogFormVisible","roleFormData","roleId","roleDesc","rules","required","message","trigger","dialogResourceFormVisible","resourceFormData","idArray","userId","resourceList","defaultProps","children","label","listLoading","created","this","getList","methods","openTableMenu","row","event","$refs","menuContext","handleFilter","_this","Object","role","then","response","resetTemp","handleCreate","_this2","$nextTick","clearValidate","handleUpdate","_this3","assign_default","editData","_this4","roleForm","validate","valid","$message","type","handleDelete","_this5","$confirm","confirmButtonText","cancelButtonText","splice","indexOf","catch","handleSizeChange","val","handleCurrentChange","handleEditResource","_this6","resource","allResourceList","filterFirstLevelResource","forEach","item","getChildResourceList","push","editResource","_this7","parentIdArray","childIdArray","tree","getCheckedNodes","node","parentId","concat","roleResourceList","resourceId","menus","menu_level","firstLevelResourceList","filter","reGenerateResourceTreeData","_this8","resoruceList","arguments","length","undefined","childResourceList","reGenerateResourceList","name","selectortype_template_index_0_src_views_role","render","_vm","_h","$createElement","_c","_self","staticClass","staticStyle","width","attrs","placeholder","model","value","callback","$$v","$set","expression","_v","icon","on","click","margin-left","directives","rawName","element-loading-text","border","fit","highlight-current-row","row-contextmenu","show-overflow-tooltip","align","scopedSlots","_u","key","fn","scope","_s","ref","background","current-page","page-sizes","page-size","layout","size-change","current-change","title","visible","update:visible","$event","label-position","label-width","prop","slot","show-checkbox","default-expand-all","node-key","highlight-current","props","default-checked-keys","staticRenderFns","Component","normalizeComponent"],"mappings":"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","file":"static/js/6.6baea919c72666458f60.js","sourcesContent":["import request from '@/utils/request'\n\nexport function getRoleListByConditionAndPage(query) {\n  return request({\n    url: '/role/rolelistbyconditionandpage',\n    method: 'get',\n    params: query\n  })\n}\n\nexport function getRoleListByCondition(query) {\n  return request({\n    url: '/role/rolelistbycondition',\n    method: 'get',\n    params: query\n  })\n}\n\nexport function getRoleListByEmployeeId(employeeId) {\n  return request({\n    url: '/role/rolelistbyemployeeid',\n    method: 'get',\n    params: {employeeId}\n  })\n}\n\nexport function editRole(data) {\n  return request({\n    url: '/role/editrole',\n    method: 'post',\n    data:data\n  })\n}\n\nexport function editRoleResource(data) {\n  return request({\n    url: '/role/editroleresource',\n    method: 'post',\n    data:data\n  })\n}\n\nexport function deleteRoleById(id) {\n  return request({\n    url: '/role/deleterolebyid',\n    method: 'post',\n    params:{id}\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/role.js","<template>\n  <div class=\"app-container role-container\">\n    <el-row class=\"app-query\">\n      <el-input v-model=\"listQuery.roleName\" placeholder=\"角色名称\"  style=\"width: 150px;\"></el-input>\n      <el-button  type=\"primary\" icon=\"el-icon-search\" @click=\"handleFilter\">查询</el-button>\n      <el-button style=\"margin-left: 10px;\" @click=\"handleCreate\" type=\"primary\" icon=\"el-icon-edit\">新增</el-button>\n    </el-row>\n\n    <el-table :data=\"list\" v-loading=\"listLoading\" element-loading-text=\"给我一点时间\" border fit highlight-current-row style=\"width: 120%\" @row-contextmenu=\"openTableMenu\">\n      <el-table-column :show-overflow-tooltip=\"true\" align=\"left\" label=\"角色名称\">\n        <template slot-scope=\"scope\">\n          <span>{{scope.row.roleName}}</span>\n        </template>\n      </el-table-column>\n      <el-table-column :show-overflow-tooltip=\"true\" align=\"left\" label=\"描述\">\n        <template slot-scope=\"scope\">\n          <span>{{scope.row.roleDesc}}</span>\n        </template>\n      </el-table-column>\n    </el-table>\n    <menu-context ref=\"menuContext\">\n      <menu-context-item @click=\"handleUpdate\">编辑</menu-context-item>\n      <menu-context-item @click=\"handleEditResource\">分配权限</menu-context-item>\n      <menu-context-item @click=\"handleDelete\">删除</menu-context-item>\n    </menu-context>\n    <div class=\"pagination-container\">\n      <el-pagination background @size-change=\"handleSizeChange\" @current-change=\"handleCurrentChange\" :current-page=\"listQuery.pageNum\" :page-sizes=\"[5,10,15,20]\" :page-size=\"listQuery.pageSize\" layout=\"total, sizes, prev, pager, next, jumper\" :total=\"listQuery.total\">\n      </el-pagination>\n    </div>\n    <div class=\"el-dialog-role\">\n      <el-dialog :title=\"textMap[dialogStatus]\" :visible.sync=\"dialogFormVisible\" width=\"30%\">\n        <el-form :rules=\"rules\" ref=\"roleForm\" :model=\"roleFormData\" label-position=\"right\" label-width=\"80px\" style='width: 70%; margin-left:50px;'>\n          <el-form-item label=\"角色名称\" prop=\"roleName\">\n            <el-input v-model=\"roleFormData.roleName\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"描述\">\n            <el-input v-model=\"roleFormData.roleDesc\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"editData\">确认</el-button>\n        </div>\n      </el-dialog>\n    </div>\n    <div  class=\"el-dialog-resource\">\n      <el-dialog title=\"分配权限\" :visible.sync=\"dialogResourceFormVisible\" width=\"15%\">\n        <el-form :rules=\"rules\" ref=\"resourceForm\" :model=\"resourceFormData\" label-position=\"right\" label-width=\"80px\" style='width: 70%; margin-left:30px;'>\n          <el-tree :data=\"resourceFormData.resourceList\" show-checkbox default-expand-all node-key=\"id\" ref=\"tree\" highlight-current :props=\"resourceFormData.defaultProps\" :default-checked-keys=\"resourceFormData.idArray\">\n          </el-tree>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogResourceFormVisible = false\">取消</el-button>\n          <el-button type=\"primary\" @click=\"editResource\">确认</el-button>\n        </div>\n      </el-dialog>\n    </div>\n  </div>\n</template>\n\n<script>\n  import {getRoleListByConditionAndPage,editRole,editRoleResource,deleteRoleById} from '@/api/role'\n  import { getResourceListByCondition,getResourceIdListByRoleId} from '@/api/resource'\n  export default {\n    data() {\n      return {\n        list: null,\n        listQuery: {\n          total:50,\n          pageNum:1,\n          pageSize:5,\n          roleName:null\n        },\n        textMap: {\n          update: '编辑',\n          create: '新增'\n        },\n        dialogStatus: '',\n        dialogFormVisible: false,\n        roleFormData: {\n          roleId:'',\n          roleName:'',\n          roleDesc:''\n        },\n        rules: {\n          roleName: [\n            { required: true, message: '角色名称不能为空', trigger: 'blur' }\n          ]\n        },\n        dialogResourceFormVisible:false,\n        resourceFormData:{\n          idArray:[],\n          userId:'',\n          roleId:'',\n          resourceList: [],\n          defaultProps: {\n            children: 'children',\n            label: 'label'\n          }\n        },\n        listLoading: true,\n      }\n    },\n    created() {\n      this.getList()\n    },\n    methods: {\n      openTableMenu(row, event) {\n        this.$refs.menuContext.openTableMenu(row,event);\n      },\n      handleFilter() {\n        this.listQuery.pageNum = 1\n        this.getList()\n      },\n      getList() {\n        this.listLoading = true\n        getRoleListByConditionAndPage(this.listQuery).then(response => {\n          const data=response.data.data\n          this.list=data.list\n          this.listQuery.total=data.total\n          this.listQuery.pageNum=data.pageNum\n          this.listQuery.pageSize=data.pageSize\n          this.listLoading = false\n        })\n      },\n      resetTemp() {\n        this.roleFormData = {\n          roleId:'',\n          roleName:'',\n          roleDesc:''\n        }\n      },\n      handleCreate() {\n        this.resetTemp()\n        this.dialogStatus = 'create'\n        this.dialogFormVisible = true\n        this.$nextTick(() => {\n          this.$refs['roleForm'].clearValidate()\n        })\n      },\n      handleUpdate(row) {\n        this.roleFormData = Object.assign({}, row) // copy obj\n        this.dialogStatus = 'update'\n        this.dialogFormVisible = true\n        this.$nextTick(() => {\n          this.$refs['roleForm'].clearValidate()\n        })\n      },\n      editData(){\n        this.$refs.roleForm.validate(valid => {\n          if (valid) {\n            editRole(this.roleFormData).then(data=>{\n              this.dialogFormVisible = false\n              this.$message({\n                message: '成功',\n                type: 'success'\n              });\n              this.getList()\n            })\n          } else {\n            return false\n          }\n        })\n      },\n      handleDelete(row) {\n        this.$confirm('确认删除?', '提示', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          type: 'warning'\n        }).then(() => {\n          deleteRoleById(row.roleId).then(data=>{\n            this.$message({\n              message: '删除成功',\n              type: 'success'\n            });\n            this.list.splice(this.list.indexOf(row), 1)\n          })\n        }).catch(() => {\n          this.$message({\n            type: 'info',\n            message: '已取消删除'\n          });\n        });\n      },\n      handleSizeChange(val) {\n        this.listQuery.pageSize = val\n        this.getList()\n      },\n      handleCurrentChange(val) {\n        this.listQuery.pageNum = val\n        this.getList()\n      },\n      handleEditResource(row){\n        this.resourceFormData.idArray=[]\n        getResourceListByCondition().then(response => {\n          const allResourceList=response.data.data\n          const resourceList=this.filterFirstLevelResource(allResourceList, 0);\n          resourceList.forEach(item=>{\n            item.children=this.getChildResourceList(item.id,allResourceList)\n          })\n          this.resourceFormData.resourceList=resourceList\n          return getResourceIdListByRoleId(row.roleId);\n        }).then(response=>{\n          let idArray=[]\n          response.data.data.forEach(resource=>{\n            idArray.push(resource.id)\n          })\n          this.resourceFormData.roleId=row.roleId\n          this.resourceFormData.idArray=idArray\n          this.dialogResourceFormVisible = true\n          this.$nextTick(() => {\n            this.$refs['resourceForm'].clearValidate()\n          })\n        })\n      },\n      editResource(){\n        let parentIdArray=[];\n        let childIdArray=[];\n        this.$refs.tree.getCheckedNodes().forEach(node=>{\n          if(parentIdArray.indexOf(node.parentId)==-1){\n            parentIdArray.push(node.parentId)\n          }\n          childIdArray.push(node.id)\n        })\n        let idArray=[]\n        parentIdArray.concat(childIdArray).forEach(id=>{\n          if(idArray.indexOf(id)==-1&&id!=0){\n            idArray.push(id)\n          }\n        })\n        let roleResourceList=[]\n        idArray.forEach(id=>{\n          roleResourceList.push({roleId:this.resourceFormData.roleId,resourceId:id})\n        })\n        editRoleResource({roleId:this.resourceFormData.roleId,roleResourceList:roleResourceList}).then(response=>{\n          this.dialogResourceFormVisible = false\n          this.$message({\n            message: '分配成功',\n            type: 'success'\n          })\n          this.getList()\n        })\n      },\n      filterFirstLevelResource(menus, menu_level){\n        const firstLevelResourceList = menus.filter(item => {\n          return item.parentId==menu_level;\n        })\n        return this.reGenerateResourceTreeData(firstLevelResourceList);\n      },\n      getChildResourceList(id,resoruceList=[]){\n        let childResourceList=[]\n        resoruceList.forEach(item=>{\n          if(id==item.parentId){\n            childResourceList.push(item)\n          }\n        })\n        childResourceList=this.reGenerateResourceTreeData(childResourceList)\n        childResourceList.forEach(item=>{\n          item.children=this.getChildResourceList(item.id,resoruceList)\n        })\n        return childResourceList\n      },\n      reGenerateResourceTreeData(resourceList){\n        let reGenerateResourceList=[]\n        resourceList.forEach(resource=>{\n          reGenerateResourceList.push({id:resource.id,parentId:resource.parentId,label:resource.name})\n        })\n        return reGenerateResourceList\n      }\n    }\n  }\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/views/role/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"app-container role-container\"},[_c('el-row',{staticClass:\"app-query\"},[_c('el-input',{staticStyle:{\"width\":\"150px\"},attrs:{\"placeholder\":\"角色名称\"},model:{value:(_vm.listQuery.roleName),callback:function ($$v) {_vm.$set(_vm.listQuery, \"roleName\", $$v)},expression:\"listQuery.roleName\"}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\",\"icon\":\"el-icon-search\"},on:{\"click\":_vm.handleFilter}},[_vm._v(\"查询\")]),_vm._v(\" \"),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"type\":\"primary\",\"icon\":\"el-icon-edit\"},on:{\"click\":_vm.handleCreate}},[_vm._v(\"新增\")])],1),_vm._v(\" \"),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.listLoading),expression:\"listLoading\"}],staticStyle:{\"width\":\"120%\"},attrs:{\"data\":_vm.list,\"element-loading-text\":\"给我一点时间\",\"border\":\"\",\"fit\":\"\",\"highlight-current-row\":\"\"},on:{\"row-contextmenu\":_vm.openTableMenu}},[_c('el-table-column',{attrs:{\"show-overflow-tooltip\":true,\"align\":\"left\",\"label\":\"角色名称\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(scope.row.roleName))])]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"show-overflow-tooltip\":true,\"align\":\"left\",\"label\":\"描述\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('span',[_vm._v(_vm._s(scope.row.roleDesc))])]}}])})],1),_vm._v(\" \"),_c('menu-context',{ref:\"menuContext\"},[_c('menu-context-item',{on:{\"click\":_vm.handleUpdate}},[_vm._v(\"编辑\")]),_vm._v(\" \"),_c('menu-context-item',{on:{\"click\":_vm.handleEditResource}},[_vm._v(\"分配权限\")]),_vm._v(\" \"),_c('menu-context-item',{on:{\"click\":_vm.handleDelete}},[_vm._v(\"删除\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"pagination-container\"},[_c('el-pagination',{attrs:{\"background\":\"\",\"current-page\":_vm.listQuery.pageNum,\"page-sizes\":[5,10,15,20],\"page-size\":_vm.listQuery.pageSize,\"layout\":\"total, sizes, prev, pager, next, jumper\",\"total\":_vm.listQuery.total},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1),_vm._v(\" \"),_c('div',{staticClass:\"el-dialog-role\"},[_c('el-dialog',{attrs:{\"title\":_vm.textMap[_vm.dialogStatus],\"visible\":_vm.dialogFormVisible,\"width\":\"30%\"},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{ref:\"roleForm\",staticStyle:{\"width\":\"70%\",\"margin-left\":\"50px\"},attrs:{\"rules\":_vm.rules,\"model\":_vm.roleFormData,\"label-position\":\"right\",\"label-width\":\"80px\"}},[_c('el-form-item',{attrs:{\"label\":\"角色名称\",\"prop\":\"roleName\"}},[_c('el-input',{model:{value:(_vm.roleFormData.roleName),callback:function ($$v) {_vm.$set(_vm.roleFormData, \"roleName\", $$v)},expression:\"roleFormData.roleName\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"描述\"}},[_c('el-input',{model:{value:(_vm.roleFormData.roleDesc),callback:function ($$v) {_vm.$set(_vm.roleFormData, \"roleDesc\", $$v)},expression:\"roleFormData.roleDesc\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogFormVisible = false}}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editData}},[_vm._v(\"确认\")])],1)],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"el-dialog-resource\"},[_c('el-dialog',{attrs:{\"title\":\"分配权限\",\"visible\":_vm.dialogResourceFormVisible,\"width\":\"15%\"},on:{\"update:visible\":function($event){_vm.dialogResourceFormVisible=$event}}},[_c('el-form',{ref:\"resourceForm\",staticStyle:{\"width\":\"70%\",\"margin-left\":\"30px\"},attrs:{\"rules\":_vm.rules,\"model\":_vm.resourceFormData,\"label-position\":\"right\",\"label-width\":\"80px\"}},[_c('el-tree',{ref:\"tree\",attrs:{\"data\":_vm.resourceFormData.resourceList,\"show-checkbox\":\"\",\"default-expand-all\":\"\",\"node-key\":\"id\",\"highlight-current\":\"\",\"props\":_vm.resourceFormData.defaultProps,\"default-checked-keys\":_vm.resourceFormData.idArray}})],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogResourceFormVisible = false}}},[_vm._v(\"取消\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.editResource}},[_vm._v(\"确认\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-152c7fd0\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/role/index.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-152c7fd0\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/role/index.vue\n// module id = null\n// module chunks = ","import request from '@/utils/request'\n\nexport function getResourceListByCondition(query) {\n  return request({\n    url: '/resource/resourcelistbycondition',\n    method: 'get',\n    params: query\n  })\n}\nexport function getResourceIdListByRoleId(roleId) {\n  return request({\n    url: '/resource/resourceidlistbyroleid',\n    method: 'get',\n    params: {roleId}\n  })\n}\nexport function editResource(data) {\n  return request({\n    url: '/resource/editresource',\n    method: 'post',\n    data:data\n  })\n}\nexport function deleteResourceById(id) {\n  return request({\n    url: '/resource/deleteresourcebyid',\n    method: 'post',\n    params:{id}\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/resource.js"],"sourceRoot":""}